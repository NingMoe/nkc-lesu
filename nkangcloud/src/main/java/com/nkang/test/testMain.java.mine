package com.nkang.test;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.UnsupportedEncodingException;
import java.net.HttpURLConnection;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLConnection;
import java.net.URLEncoder;
import java.util.ArrayList;
import java.util.List;

import org.json.JSONObject;

import com.nkang.kxmoment.baseobject.WeChatMDLUser;
import com.nkang.kxmoment.util.Constants;
import com.nkang.kxmoment.util.MongoDBBasic;
import com.nkang.kxmoment.util.RestUtils;




public class testMain{
	public static void main(String[] args) throws Exception {
		
		//loading data from mdm to baidu cloud
		
/*	StopWatch sw = new StopWatch();
		sw.start();
		System.out.println("starting data load--please wait");
		List<OrgOtherPartySiteInstance> opsiList = new ArrayList<OrgOtherPartySiteInstance>();
		opsiList = SolrClientUtils.getOPSIList(9);  // 1 of 33
		for (OrgOtherPartySiteInstance opsi : opsiList) {
			RestUtils.callMasterDataUpsert(opsi);
		}
		sw.getElapsedMs();
		System.out.println("over all loading time : " + sw);
*/
		
		System.out.println(getWeatherInform("重庆"));

     }
	public static String  getWeatherInform(String cityName){ 
        String baiduUrl = "http://sou.qq.com/online/get_weather.php?callback=Weather&city=";  
        StringBuffer strBuf;  
        try {                              
            baiduUrl = "http://sou.qq.com/online/get_weather.php?callback=Weather&city="+URLEncoder.encode(cityName, "utf-8");                    
        } catch (UnsupportedEncodingException e1) {               
            e1.printStackTrace();                     
        }  
        strBuf = new StringBuffer();  
        try{  
            URL url = new URL(baiduUrl);  
		    System.setProperty("http.proxyHost", Constants.proxyInfo);  
		    System.setProperty("http.proxyPort", "8080");  
	        System.setProperty("sun.net.client.defaultConnectTimeout", "30000");
	        System.setProperty("sun.net.client.defaultReadTimeout", "30000"); 
	        URLConnection conn = url.openConnection();
            BufferedReader reader = new BufferedReader(new InputStreamReader(conn.getInputStream(),"utf-8"));//转码。  
            String line = null;  
            while ((line = reader.readLine()) != null)  
                strBuf.append(line + " ");  
                reader.close();  
        }catch(MalformedURLException e) {  
            e.printStackTrace();   
        }catch(IOException e){  
            e.printStackTrace();   
        }     

        return strBuf.toString();  
    }  
}
